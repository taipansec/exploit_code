#!/usr/bin/python3

# Exploit Title: Deserialization example
# Date: 2021-10-19
# Exploit Author: Youssef B
# Tested against: Pickle


import pickle, base64


def desert():
    token = "gAN9cQAoWAQAAABhdXRocQFLAFgGAAAAdXNlcmlkcQJYJAAAADAwMDAwMDAwLTAwMDAtNDAwMC04MDAwLTAwMDAwMDAwMDAwMHEDdS4="

    serialdata = base64.b64decode(token)

    deserialdata = pickle.loads(serialdata)

    print(deserialdata)

def resert():
    token = {'auth': 0, 'userid': 'b1c7f094-cbd4-44a0-91c3-e23dcb8962f1'}

    serial = pickle.dumps(token)

    serialb64 = base64.b64encode(serial)

    print(serialb64)
  
if __name__ == '__main__':
    desert()
    resert()
